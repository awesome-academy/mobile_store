<% provide(:title, 'gio hang cua ban') %>

<div class="modal-content">
    <div class="modal-header line-height-fixed font-size-lg">
    	<%if @order_details.nil?%>
			<strong class="mx-auto">Giỏ hàng của bạn (0)</strong>
			<ul class="list-group list-group-lg list-group-flush">
		    <p class="empty">Chưa có sam phẩm nào trong giỏ hàng</p>
		    	<%= link_to 'TIẾP TỤC MUA SẮM', root_path, class:"order" %>
	    	</ul>
    	<%else%>
	        <% @count = 0%>
			<% @order_details.each do |order_detail| %>
				<% quantity = order_detail.last %>
				<% @count += quantity %>
				
			<% end %>	
       		<strong class="mx-auto">Giỏ hàng của bạn (<%= @count %>)</strong>
  
    </div>

		    <ul class="list-group list-group-lg list-group-flush">
			    <% @sum = 0%>
			    <% @count = 0%>
				<% @order_details.each do |order_detail|  %>
					<% @product = Product.find(order_detail.first.to_i)%>
					<% quantity = order_detail.last %>
					<% unit_price = @product.price*quantity %>

		          <!-- List group -->

			      
			            <li class="list-group-item"  id="product-<%= @product.id %>">
			              <div class="row align-items-center">
			                <div class="col-4">

			                  <!-- Image -->
			                  <a href="./product.html">
			                    <img class="img-fluid-<%= @product.id %>" src="./assets/img/products/product-6.jpg" alt="...">
			                  </a>

			                </div>
			                <div class="col-8">

			                  <!-- Title -->
			                  <p class="font-size-sm font-weight-bold mb-6">
			                    <a class="text-body-<%= @product.id %>" href="#">
			                    	<%= "#{@product.name}" %></a>
			                    	<p id="list-<%= @product.id %>">So lương:

			                    		<span id = "minus-<%= @product.id %>"><%= link_to '-', edit_cart_path(order_detail.first.to_i), class:"btn-button" ,remote:true  %></span>
			                    		<span id ="pro-<%= @product.id %>"><%= @quantity %></span>
			                    		<%= quantity %>
										<span id = "plus-<%= @product.id %>"><%= link_to '+', edit_cart_path(order_detail.first.to_i, val: "add"), remote: true,class:"btn-button"%></span></br>
			                    		<span class="text-muted"><%= "#{@product.price} VND" %></span>
			                    	</p>
			                  </p>

			                  <!--Footer -->
			                  <div class="d-flex align-items-center">
				                    <!-- Remove -->
				                    <%= link_to 'Remove', cart_path(order_detail.first.to_i),
			                    	method: :delete, data: { confirm: "You sure?" }, remote: true, class:"font-size-xs text-gray-400 ml-auto" %>
			                  </div>

			                </div>
			              </div>
			            </li>
			   			<% @sum += unit_price %>       
			       
		     	<% end %>
		     </ul> 
			    <div id = "sum-ajax" , align="center"> <span> Tong tien:<%= @sum %> VND </span></div>
			    <%= link_to 'TIẾP TỤC MUA SẮM', root_path, class:"order" %>
				<%= link_to 'TIẾN HÀNH ĐẶT HÀNG', new_order_path, class:"order" %>
		<%end%>

</div>

